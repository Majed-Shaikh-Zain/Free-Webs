<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Neon Job Manager Dashboard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
  <style>
    :root {
      --primary-color: #00e6e6;
      --primary-dark: #009999;
      --background-dark: #121212;
      --background-darker: #0a0a0a;
      --text-color: #e0e0e0;
      --card-background: #1e1e1e;
      --neon-intensity: 0.4;
      --neon-rgb: 0, 255, 255;
    }
    /* Light mode removed; all colors are now controlled by pre-made themes */

    /* Global Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      transition: background-color 0.3s, color 0.3s;
    }
    html, body {
      height: 100%; /* Ensure full height */
      overflow: hidden; /* Prevent overflow */
    }
    body {
      font-family: var(--font-family, Arial), sans-serif;
      background-color: var(--background-dark);
      color: var(--text-color);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      margin: 0; /* Ensure no extra margin */
      padding: 0; /* Ensure no extra padding */
      overflow-x: hidden; /* Prevent horizontal scrolling */
    }
    /* Sidebar */
    .sidebar {
      width: 280px;
      height: 100vh;
      background: var(--background-darker);
      padding: 20px 0;
      position: fixed;
      transition: transform 0.3s ease;
      overflow-y: auto;
    }
    .sidebar h2 {
      text-align: center;
      color: var(--primary-color);
      font-size: 1.8em;
      margin-bottom: 30px;
      text-shadow: 0 0 10px rgba(var(--neon-rgb), var(--neon-intensity));
    }
    .sidebar ul {
      list-style: none;
      padding: 0;
    }
    .sidebar ul li {
      padding: 0 20px;
      margin-bottom: 10px;
    }
    .sidebar ul li a {
      color: var(--text-color);
      text-decoration: none;
      display: flex;
      align-items: center;
      padding: 12px 20px;
      border-radius: 8px;
    }
    .sidebar ul li a:hover,
    .sidebar ul li a.active {
      background: rgba(0, 255, 255, 0.1);
      color: var(--primary-color);
    }
    .sidebar ul li a i {
      margin-right: 10px;
      width: 20px;
      text-align: center;
    }
    /* Main Content */
    .main-content {
      margin-left: 280px;
      padding: 20px;
      flex-grow: 1;
      background: var(--background-dark); /* Updated to use theme background */
      transition: background 0.3s ease; /* Smooth transition for theme changes */
      min-height: calc(100vh - 20px); /* Adjust for padding/margin */
      overflow-y: auto; /* Allow vertical scrolling within content */
      margin-bottom: 0; /* Remove any bottom margin */
      padding-bottom: 0; /* Remove any bottom padding */
    }
    /* Cards */
    .card {
      background: var(--card-background);
      border-radius: 15px;
      padding: 30px;
      margin-bottom: 20px;
      box-shadow: 0 0 20px rgba(var(--neon-rgb), var(--neon-intensity));
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      position: relative;
    }
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 0 25px rgba(var(--neon-rgb), var(--neon-intensity));
    }
    .card h2 { margin-bottom: 30px; }
    .form-group {
      display: grid;
      gap: 15px;
      margin-bottom: 20px;
    }
    input, textarea {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid var(--primary-color);
      border-radius: 8px;
      padding: 12px;
      color: var(--text-color);
      font-size: 1em;
    }
    input:focus, textarea:focus {
      outline: none;
      box-shadow: 0 0 10px var(--primary-color);
    }
    /* Styled Dropdowns */
    select {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      background: var(--card-background);
      border: 1px solid var(--primary-color);
      border-radius: 8px;
      padding: 12px 40px 12px 12px;
      color: var(--text-color);
      font-size: 1em;
      background-image: url("data:image/svg+xml,%3Csvg%20width%3D'12'%20height%3D'8'%20xmlns%3D'http://www.w3.org/2000/svg'%3E%3Cpolygon%20points%3D'0,0%2012,0%206,8'%20fill%3D'%23e0e0e0'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 10px center;
      background-size: 12px;
    }
    /* Styled Scrollbar for Theme Dropdown */
    #premade-theme {
      max-height: 150px; /* Limit height for scrolling */
      overflow-y: auto;
      scrollbar-width: thin; /* Firefox */
      scrollbar-color: var(--primary-color) var(--card-background); /* Firefox */
    }
    #premade-theme::-webkit-scrollbar {
      width: 8px;
    }
    #premade-theme::-webkit-scrollbar-track {
      background: var(--card-background);
    }
    #premade-theme::-webkit-scrollbar-thumb {
      background: var(--primary-color);
      border-radius: 4px;
    }
    #premade-theme::-webkit-scrollbar-thumb:hover {
      background: var(--primary-dark);
    }
    /* Button */
    .btn-primary {
      background: var(--primary-color);
      color: var(--background-darker);
      border: none;
      padding: 12px 25px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }
    .btn-primary:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
    }
    /* Toolbar Buttons */
    .btn-toolbar {
      background: var(--primary-color);
      color: var(--background-darker);
      border: none;
      padding: 8px 15px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      font-size: 1em;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.3s, transform 0.2s;
    }
    .btn-toolbar:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
    }
    .btn-clear {
      background: #ff4444;
      color: white;
    }
    .btn-clear:hover {
      background: #cc0000;
    }
    /* Lists & Dividers */
    .task-list, .event-list, #schedule-list {
      list-style: none;
      margin-top: 20px;
    }
    .task-list li, .event-list li, #schedule-list li {
      background: rgba(255, 255, 255, 0.05);
      margin-bottom: 10px;
      padding: 15px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    .task-list li:hover, .event-list li:hover, #schedule-list li:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    .task-list li.completed span {
      opacity: 0.7;
      text-decoration: line-through;
    }
    .filter-btn {
      background: transparent;
      border: 1px solid var(--primary-color);
      color: var(--text-color);
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
    }
    .filter-btn:hover, .filter-btn.active {
      background: var(--primary-color);
      color: var(--background-darker);
    }
    /* Delete Button */
    .delete-btn {
      background: rgba(255, 68, 68, 0.1);
      border: 1px solid #ff4444;
      color: #ff4444;
      cursor: pointer;
      padding: 8px 12px;
      border-radius: 6px;
      transition: transform 0.3s;
      margin-left: 10px;
    }
    .delete-btn:hover {
      background: rgba(255, 68, 68, 0.2);
      transform: translateY(-2px);
    }
    /* Adjust Contacts Delete Button */
    .contact-card {
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      padding-bottom: 10px;
      margin-bottom: 10px;
    }
    /* Divider for Notes */
    .note-card {
      border-bottom: 1px solid rgba(255,255,255,0.1);
      padding-bottom: 10px;
      margin-bottom: 10px;
    }
    /* Fix Project Delete Button Positioning */
    .project-card {
      position: relative;
      padding-top: 40px;
    }
    .project-card .delete-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      margin: 0;
    }
    /* Dashboard Stats */
    .project-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .stat-card {
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      box-shadow: 0 0 15px rgba(var(--neon-rgb), var(--neon-intensity));
    }
    .stat-card h3 { margin-bottom: 10px; }
    .stat-number { font-size: 2em; color: var(--primary-color); }
    /* Dashboard Layout */
    .dashboard-container {
      display: grid;
      grid-template-rows: auto auto auto;
      gap: 20px;
    }
    .welcome-section { }
    .stats-section { }
    .activity-section { }
    .welcome-card {
      background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
      color: var(--background-darker);
      padding: 40px;
      border-radius: 15px;
      text-align: center;
      font-size: 2em;
      box-shadow: 0 0 25px rgba(var(--neon-rgb), var(--neon-intensity));
    }
    .welcome-card h1 { margin-bottom: 10px; font-size: 2.5em; }
    .welcome-card p { font-size: 1.2em; }
    /* Recent Activity Section */
    .activity-section {
      padding: 20px;
      border-radius: 15px;
      background: rgba(255,255,255,0.05);
      box-shadow: 0 0 15px rgba(var(--neon-rgb), var(--neon-intensity));
    }
    .activity-section h2 { margin-bottom: 15px; }
    .activity-section ul { list-style: none; padding-left: 15px; }
    .activity-section ul li { margin-bottom: 5px; }
    /* Uni Schedule Table Styles */
    #active-days-selector {
      margin-bottom: 20px;
    }
    #active-days-selector p {
      margin-bottom: 10px;
    }
    #active-days-selector label {
      margin-right: 10px;
    }
    #schedule-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    #schedule-table th, #schedule-table td {
      border: 1px solid rgba(255,255,255,0.1);
      padding: 8px;
      text-align: center;
      vertical-align: top;
    }
    #schedule-table th {
      background: var(--background-darker);
    }
    .schedule-item {
      margin-bottom: 5px;
      border-bottom: 1px dashed rgba(255,255,255,0.2);
      padding-bottom: 3px;
    }
    .schedule-item button {
      background: transparent;
      border: none;
      color: var(--primary-color);
      cursor: pointer;
      font-size: 0.8em;
    }
    /* Page Sections */
    .page { display: none; padding: 20px; }
    .page.active { display: block; }
    /* Loading */
    .loading-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .spinner {
      width: 50px; height: 50px;
      border: 3px solid transparent;
      border-top-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    /* Settings: Pre-made Themes */
    .settings-section select {
      font-size: 1em;
      margin-top: 10px; /* Extra space above theme selector */
      margin-bottom: 10px; /* Extra space below theme selector */
    }
    /* Advanced Settings */
    .advanced-settings {
      margin-top: 40px;
      border-top: 1px solid rgba(255,255,255,0.1);
      padding-top: 20px;
    }
    .setting-item {
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .setting-item label { flex: 1; }
    .setting-item input[type="color"] {
      padding: 0;
      border: none;
      background: none;
      width: 40px;
      height: 40px;
      cursor: pointer;
    }

    /* Level-Based Neon Intensity Bar */
    .intensity-bar-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
      margin-bottom: 10px;
      width: 100%; /* Ensure it spans the card width */
    }
    .intensity-bar {
      display: flex;
      gap: 5px;
      width: 100%; /* Full width of the container */
      max-width: 600px; /* Optional: Limit maximum width */
      height: 30px; /* Slightly taller for better visibility */
    }
    .intensity-level {
      flex: 1;
      height: 100%;
      border-radius: 4px;
      background: var(--card-background);
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
      cursor: pointer;
    }
    .intensity-level.active {
      box-shadow: 0 0 10px rgba(var(--neon-rgb), var(--neon-intensity));
    }
    .intensity-level.green.active {
      background: #39ff14;
      box-shadow: 0 0 10px #39ff14; /* Green neon border */
    }
    .intensity-level.yellow.active {
      background: #ffcc00;
      box-shadow: 0 0 10px #ffcc00; /* Yellow neon border */
    }
    .intensity-level.red.active {
      background: #ff073a;
      box-shadow: 0 0 10px #ff073a; /* Red neon border */
    }
    .intensity-value {
      font-size: 1.2em;
      color: var(--text-color);
    }
  </style>
</head>
<body>
  <div class="loading-overlay">
    <div class="spinner"></div>
  </div>

  <div class="sidebar">
    <h2><i class="fas fa-tasks"></i> Job Manager</h2>
    <ul>
      <li><a href="#dashboard" class="active" data-page="dashboard"><i class="fas fa-home"></i> Dashboard</a></li>
      <li><a href="#tasks" data-page="tasks"><i class="fas fa-list"></i> Tasks</a></li>
      <li><a href="#calendar" data-page="calendar"><i class="fas fa-calendar"></i> Calendar</a></li>
      <li><a href="#projects" data-page="projects"><i class="fas fa-project-diagram"></i> Projects</a></li>
      <li><a href="#files" data-page="files"><i class="fas fa-file"></i> Files</a></li>
      <li><a href="#notes" data-page="notes"><i class="fas fa-sticky-note"></i> Notes</a></li>
      <li><a href="#contacts" data-page="contacts"><i class="fas fa-address-book"></i> Contacts</a></li>
      <li><a href="#schedule" data-page="schedule" class="schedule-icon"><i class="fas fa-book"></i> Uni Schedule</a></li>
      <li><a href="#settings" data-page="settings"><i class="fas fa-cog"></i> Settings</a></li>
    </ul>
  </div>

  <div class="main-content">
    <!-- Dashboard Page -->
    <div id="dashboard" class="page active">
      <div class="dashboard-container">
        <!-- Welcome Section -->
        <div class="welcome-section">
          <div class="welcome-card card">
            <h1 id="welcome-message-display"></h1>
            <p id="current-date-display"></p>
          </div>
        </div>
        <!-- Stats Section -->
        <div class="stats-section card">
          <h2>Overview</h2>
          <div class="project-stats">
            <div class="stat-card">
              <h3>Active Tasks</h3>
              <p class="stat-number" id="active-tasks-count">0</p>
            </div>
            <div class="stat-card">
              <h3>Events Today</h3>
              <p class="stat-number" id="events-today-count">0</p>
            </div>
            <div class="stat-card">
              <h3>Projects</h3>
              <p class="stat-number" id="projects-count">0</p>
            </div>
          </div>
        </div>
        <!-- Recent Activity Section -->
        <div class="activity-section card">
          <h2>Recent Activity</h2>
          <div id="recent-activity-content">
            <!-- This will display the most recent task, event, and project -->
          </div>
        </div>
      </div>
    </div>

    <!-- Tasks Page -->
    <div id="tasks" class="page">
      <div class="card">
        <h2><i class="fas fa-tasks"></i> Task Management</h2>
        <form id="task-form" class="form-group">
          <input type="text" id="task-input" placeholder="Enter task title" required>
          <input type="date" id="task-due-date" required>
          <select id="task-priority" required>
            <option value="low">Low Priority</option>
            <option value="medium">Medium Priority</option>
            <option value="high">High Priority</option>
          </select>
          <button type="submit" class="btn-primary">Add Task</button>
        </form>
        <div class="task-filters">
          <button class="filter-btn active" data-filter="all">All</button>
          <button class="filter-btn" data-filter="pending">Pending</button>
          <button class="filter-btn" data-filter="completed">Completed</button>
        </div>
        <ul id="task-list" class="task-list"></ul>
      </div>
    </div>

    <!-- Calendar Page -->
    <div id="calendar" class="page">
      <div class="card">
        <h2><i class="fas fa-calendar"></i> Event Calendar</h2>
        <form id="event-form" class="form-group">
          <input type="text" id="event-title" placeholder="Event title" required>
          <input type="date" id="event-date" required>
          <input type="time" id="event-time" required>
          <textarea id="event-description" placeholder="Event description"></textarea>
          <button type="submit" class="btn-primary">Add Event</button>
        </form>
        <ul id="event-list" class="event-list"></ul>
      </div>
    </div>

    <!-- Projects Page -->
    <div id="projects" class="page">
      <div class="card">
        <h2><i class="fas fa-project-diagram"></i> Projects</h2>
        <form id="project-form" class="form-group">
          <input type="text" id="project-name" placeholder="Project Name" required>
          <textarea id="project-description" placeholder="Project Description" required></textarea>
          <select id="project-status" required>
            <option value="planning">Planning</option>
            <option value="in-progress">In Progress</option>
            <option value="completed">Completed</option>
            <option value="on-hold">On Hold</option>
          </select>
          <input type="date" id="project-deadline" required>
          <button type="submit" class="btn-primary">Add Project</button>
        </form>
        <div class="project-grid"></div>
      </div>
    </div>

    <!-- Files Page -->
    <div id="files" class="page">
      <div class="card">
        <h2><i class="fas fa-file"></i> File Management</h2>
        <div class="file-upload-area" style="cursor:pointer; text-align:center;">
          <i class="fas fa-cloud-upload-alt"></i>
          <p>Drag and drop files here or click to upload</p>
        </div>
        <input type="file" id="file-input" style="display:none" multiple>
        <div id="file-list" class="file-list"></div>
      </div>
    </div>

    <!-- Notes Page -->
    <div id="notes" class="page">
      <div class="card">
        <h2><i class="fas fa-sticky-note"></i> Notes</h2>
        <form id="note-form" class="form-group">
          <input type="text" id="note-title" placeholder="Note Title" required>
          <!-- Enhanced Rich Text Toolbar -->
          <div class="toolbar" style="display: flex; gap: 10px; margin-bottom: 10px;">
            <button type="button" class="btn-toolbar" onclick="document.execCommand('bold')" title="Bold"><b>B</b></button>
            <button type="button" class="btn-toolbar" onclick="document.execCommand('italic')" title="Italic"><i>I</i></button>
            <button type="button" class="btn-toolbar" onclick="document.execCommand('underline')" title="Underline"><u>U</u></button>
            <button type="button" class="btn-toolbar" onclick="document.execCommand('foreColor', false, prompt('Enter a color (e.g., red, #ff0000):'))" title="Text Color">A</button>
            <button type="button" class="btn-toolbar" onclick="document.execCommand('removeFormat')" title="Remove Formatting">✖</button>
            <button type="button" class="btn-toolbar btn-clear" onclick="clearFormatting()" title="Clear All Formatting">Clear</button>
          </div>
          <div contenteditable="true" id="note-content" class="rich-text-editor" placeholder="Write your note here..." style="border: 1px solid var(--primary-color); padding: 10px; min-height: 100px; border-radius: 8px;"></div>
          <select id="note-category">
            <option value="work">Work</option>
            <option value="personal">Personal</option>
            <option value="ideas">Ideas</option>
            <option value="todos">To-Dos</option>
          </select>
          <button type="submit" class="btn-primary">Add Note</button>
        </form>
        <div class="notes-container"></div>
      </div>
    </div>

    <!-- Contacts Page -->
    <div id="contacts" class="page">
      <div class="card">
        <h2><i class="fas fa-address-book"></i> Contacts</h2>
        <form id="contact-form" class="form-group">
          <input type="text" id="contact-name" placeholder="Full Name" required>
          <input type="email" id="contact-email" placeholder="Email Address" required>
          <input type="tel" id="contact-phone" placeholder="Phone Number">
          <select id="contact-category">
            <option value="work">Work</option>
            <option value="personal">Personal</option>
            <option value="client">Client</option>
            <option value="vendor">Vendor</option>
          </select>
          <textarea id="contact-notes" placeholder="Additional Notes"></textarea>
          <button type="submit" class="btn-primary">Add Contact</button>
        </form>
        <div class="contacts-list"></div>
      </div>
    </div>

    <!-- Uni Schedule Page -->
    <div id="schedule" class="page">
      <div class="card">
        <h2><i class="fas fa-book"></i> Uni Schedule</h2>
        <!-- Active Days Selector -->
        <div id="active-days-selector">
          <p>Select your active days:</p>
          <label><input type="checkbox" value="Sunday"> Sunday</label>
          <label><input type="checkbox" value="Monday"> Monday</label>
          <label><input type="checkbox" value="Tuesday"> Tuesday</label>
          <label><input type="checkbox" value="Wednesday"> Wednesday</label>
          <label><input type="checkbox" value="Thursday"> Thursday</label>
          <label><input type="checkbox" value="Friday"> Friday</label>
          <label><input type="checkbox" value="Saturday"> Saturday</label>
          <button id="save-active-days" class="btn-primary">Save Active Days</button>
        </div>
        <!-- Schedule Item Form -->
        <form id="schedule-form" class="form-group">
          <input type="text" id="schedule-subject" placeholder="Subject" required>
          <select id="schedule-day" required>
            <option value="Sunday">Sunday</option>
            <option value="Monday" selected>Monday</option>
            <option value="Tuesday">Tuesday</option>
            <option value="Wednesday">Wednesday</option>
            <option value="Thursday">Thursday</option>
            <option value="Friday">Friday</option>
            <option value="Saturday">Saturday</option>
          </select>
          <input type="time" id="schedule-start" required>
          <input type="time" id="schedule-end" required>
          <input type="text" id="schedule-location" placeholder="Location" required>
          <button type="submit" class="btn-primary">Add Schedule Item</button>
        </form>
        <!-- Schedule Table Container -->
        <div id="schedule-table-container"></div>
      </div>
    </div>

    <!-- Settings Page -->
    <div id="settings" class="page">
      <div class="card">
        <h2><i class="fas fa-cog"></i> Appearance Settings</h2>
        <!-- Pre-made Themes Selector -->
        <h3>Pre-made Themes</h3>
        <div class="settings-section">
          <select id="premade-theme">
            <option value="classic" selected>Classic Neon</option>
            <option value="electric">Electric Blue</option>
            <option value="cyberpunk">Cyberpunk</option>
            <option value="solarized">Solarized Dark</option>
            <option value="midnight">Midnight</option>
            <option value="neonGreen">Neon Green</option>
            <option value="neonPurple">Neon Purple</option>
            <option value="neonOrange">Neon Orange</option>
            <option value="neonRed">Neon Red</option>
            <option value="neonTeal">Neon Teal</option>
            <option value="neonCoral">Neon Coral</option>
            <option value="gradient">Gradient</option>
            <option value="sunset">Sunset</option>
            <option value="aurora">Aurora</option>
            <option value="skyline">Skyline</option>
            <option value="forest">Forest</option>
            <option value="ocean">Ocean</option>
            <option value="dawn">Dawn</option>
            <option value="candy">Candy</option>
            <option value="galaxy">Galaxy</option>
            <option value="spring">Spring</option>
            <option value="volcano">Volcano</option>
          </select>
        </div>
        <!-- Neon Intensity -->
        <h3>Neon Intensity</h3>
        <div class="intensity-bar-container">
          <div class="intensity-bar" id="intensity-bar">
            <div class="intensity-level green" data-level="1"></div>
            <div class="intensity-level green" data-level="2"></div>
            <div class="intensity-level green" data-level="3"></div>
            <div class="intensity-level yellow" data-level="4"></div>
            <div class="intensity-level yellow" data-level="5"></div>
            <div class="intensity-level yellow" data-level="6"></div>
            <div class="intensity-level red" data-level="7"></div>
            <div class="intensity-level red" data-level="8"></div>
            <div class="intensity-level red" data-level="9"></div>
          </div>
          <div class="intensity-value" id="intensity-value">40%</div>
        </div>
        <!-- Advanced Settings -->
        <h3>Advanced Settings</h3>
        <div class="advanced-settings">
          <div class="setting-item">
            <label for="font-family">Font Family:</label>
            <select id="font-family">
              <option value="Arial" selected>Arial</option>
              <option value="Helvetica">Helvetica</option>
              <option value="Times New Roman">Times New Roman</option>
              <option value="Courier New">Courier New</option>
              <option value="Verdana">Verdana</option>
              <option value="Roboto">Roboto</option>
              <option value="Lobster">Lobster</option>
              <option value="Pacifico">Pacifico</option>
              <option value="Montserrat">Montserrat</option>
              <option value="Playfair Display">Playfair Display</option>
              <option value="Raleway">Raleway</option>
              <option value="Oswald">Oswald</option>
              <option value="Dancing Script">Dancing Script</option>
            </select>
          </div>
          <div class="setting-item">
            <label for="text-size">Text Size: <span id="text-size-value">16</span>px</label>
            <input type="range" id="text-size" min="12" max="24" step="1" value="16">
          </div>
          <!-- Background color option removed -->
          <div class="setting-item">
            <label for="sound-notifications">Sound Notifications:</label>
            <input type="checkbox" id="sound-notifications" checked>
          </div>
          <div class="setting-item">
            <label for="welcome-message">Custom Welcome Message:</label>
            <input type="text" id="welcome-message" placeholder="Welcome back, User!" style="flex:2;">
          </div>
          <div class="setting-item">
            <button id="reset-settings" class="btn-primary">Reset All Data</button>
          </div>
        </div>
        <!-- New Sections -->
        <h3>Dark Mode</h3>
        <div class="setting-item">
          <label for="dark-mode-toggle">Enable Dark Mode:</label>
          <input type="checkbox" id="dark-mode-toggle" checked>
        </div>
        <h3>Language</h3>
        <div class="setting-item">
          <label for="language-selector">Select Language:</label>
          <select id="language-selector">
            <option value="en" selected>English</option>
            <option value="es">Spanish</option>
            <option value="fr">French</option>
            <option value="de">German</option>
            <option value="zh">Chinese</option>
          </select>
        </div>
      </div>
    </div>
  </div>
  <script>
    // Pre-made theme definitions – add as many as you like
    const preMadeThemes = {
      classic: {
        '--primary-color': '#00e6e6',
        '--primary-dark': '#009999',
        '--background-dark': '#121212', /* Main content background */
        '--background-darker': '#0a0a0a',
        '--text-color': '#e0e0e0',
        '--card-background': '#1e1e1e',
        '--neon-intensity': '0.4',
        '--neon-rgb': '0, 255, 255'
      },
      electric: {
        '--primary-color': '#00aaff',
        '--primary-dark': '#0077cc',
        '--background-dark': '#0d0a2b',
        '--background-darker': '#07073a',
        '--text-color': '#ffffff',
        '--card-background': '#131336',
        '--neon-intensity': '0.4',
        '--neon-rgb': '0,170,255'
      },
      cyberpunk: {
        '--primary-color': '#ff0066',
        '--primary-dark': '#cc0052',
        '--background-dark': '#1a1a1a',
        '--background-darker': '#0e0e0e',
        '--text-color': '#f0f0f0',
        '--card-background': '#262626',
        '--neon-intensity': '0.5',
        '--neon-rgb': '255,0,102'
      },
      solarized: {
        '--primary-color': '#268bd2',
        '--primary-dark': '#1c6ea4',
        '--background-dark': '#002b36',
        '--background-darker': '#073642',
        '--text-color': '#839496',
        '--card-background': '#073642',
        '--neon-intensity': '0.3',
        '--neon-rgb': '38,139,210'
      },
      midnight: {
        '--primary-color': '#8a2be2',
        '--primary-dark': '#6e1da2',
        '--background-dark': '#000033',
        '--background-darker': '#00001a',
        '--text-color': '#cccccc',
        '--card-background': '#1a1a33',
        '--neon-intensity': '0.4',
        '--neon-rgb': '138,43,226'
      },
      neonGreen: {
        '--primary-color': '#39FF14',
        '--primary-dark': '#2FB80F',
        '--background-dark': '#0d2a0d',
        '--background-darker': '#081f08',
        '--text-color': '#e0e0e0',
        '--card-background': '#1e3e1e',
        '--neon-intensity': '0.4',
        '--neon-rgb': '57,255,20'
      },
      neonPurple: {
        '--primary-color': '#B026FF',
        '--primary-dark': '#8E1ACC',
        '--background-dark': '#1c0d2a',
        '--background-darker': '#140a1f',
        '--text-color': '#e0e0e0',
        '--card-background': '#2e1c3e',
        '--neon-intensity': '0.4',
        '--neon-rgb': '176,38,255'
      },
      neonOrange: {
        '--primary-color': '#FF5F1F',
        '--primary-dark': '#CC4A18',
        '--background-dark': '#2a130d',
        '--background-darker': '#1f0f0a',
        '--text-color': '#e0e0e0',
        '--card-background': '#3e1e1e',
        '--neon-intensity': '0.4',
        '--neon-rgb': '255,95,31'
      },
      neonRed: {
        '--primary-color': '#FF073A',
        '--primary-dark': '#CC0530',
        '--background-dark': '#330d0d',
        '--background-darker': '#2a0a0a',
        '--text-color': '#e0e0e0',
        '--card-background': '#4e1e1e',
        '--neon-intensity': '0.4',
        '--neon-rgb': '255,7,58'
      },
      neonTeal: {
        '--primary-color': '#00FFC5',
        '--primary-dark': '#00CC9E',
        '--background-dark': '#0d2a27',
        '--background-darker': '#08201e',
        '--text-color': '#e0e0e0',
        '--card-background': '#1e3e3e',
        '--neon-intensity': '0.4',
        '--neon-rgb': '0,255,197'
      },
      neonCoral: {
        '--primary-color': '#FF7F50',
        '--primary-dark': '#CC6642',
        '--background-dark': '#2a150d',
        '--background-darker': '#1f110a',
        '--text-color': '#e0e0e0',
        '--card-background': '#3e2e1e',
        '--neon-intensity': '0.4',
        '--neon-rgb': '255,127,80'
      },
      gradient: {
        '--primary-color': '#ff7f50',
        '--primary-dark': '#ff1493',
        '--background-dark': '#1e1e1e',
        '--background-darker': '#121212',
        '--text-color': '#ffffff',
        '--card-background': '#1e1e1e',
        '--neon-intensity': '0.5',
        '--neon-rgb': '255,127,80'
      },
      sunset: {
        '--primary-color': '#ff4500',
        '--primary-dark': '#ff6347',
        '--background-dark': '#2a130d',
        '--background-darker': '#1f0f0a',
        '--text-color': '#ffffff',
        '--card-background': '#3e1e1e',
        '--neon-intensity': '0.4',
        '--neon-rgb': '255,69,0'
      },
      aurora: {
        '--primary-color': '#00ffcc',
        '--primary-dark': '#00bfff',
        '--background-dark': '#0d2a27',
        '--background-darker': '#08201e',
        '--text-color': '#ffffff',
        '--card-background': '#1e3e3e',
        '--neon-intensity': '0.5',
        '--neon-rgb': '0,255,204'
      },
      skyline: {
        '--primary-color': '#87ceeb',
        '--primary-dark': '#4682b4',
        '--background-dark': 'linear-gradient(to bottom, #87ceeb, #4682b4)',
        '--background-darker': '#1e1e1e',
        '--text-color': '#ffffff',
        '--card-background': '#1e1e1e',
        '--neon-intensity': '0.4',
        '--neon-rgb': '135,206,235'
      },
      forest: {
        '--primary-color': '#228b22',
        '--primary-dark': '#006400',
        '--background-dark': 'linear-gradient(to bottom, #228b22, #006400)',
        '--background-darker': '#1e1e1e',
        '--text-color': '#ffffff',
        '--card-background': '#1e1e1e',
        '--neon-intensity': '0.4',
        '--neon-rgb': '34,139,34'
      },
      ocean: {
        '--primary-color': '#1e90ff',
        '--primary-dark': '#000080',
        '--background-dark': 'linear-gradient(to bottom, #1e90ff, #000080)',
        '--background-darker': '#1e1e1e',
        '--text-color': '#ffffff',
        '--card-background': '#1e1e1e',
        '--neon-intensity': '0.4',
        '--neon-rgb': '30,144,255'
      },
      dawn: {
        '--primary-color': '#ff7f50',
        '--primary-dark': '#ff1493',
        '--background-dark': 'linear-gradient(to bottom, #ff7f50, #ff1493, #1e90ff)',
        '--background-darker': '#1e1e1e',
        '--text-color': '#ffffff',
        '--card-background': '#1e1e1e',
        '--neon-intensity': '0.4',
        '--neon-rgb': '255,127,80'
      },
      candy: {
        '--primary-color': '#ff69b4',
        '--primary-dark': '#ff1493',
        '--background-dark': 'linear-gradient(to bottom, #ff69b4, #ff1493, #ff4500)', /* Main content background */
        '--background-darker': '#1e1e1e',
        '--text-color': '#ffffff',
        '--card-background': '#1e1e1e',
        '--neon-intensity': '0.4',
        '--neon-rgb': '255,105,180'
      },
      galaxy: {
        '--primary-color': '#1a1a2e',
        '--primary-dark': '#16213e',
        '--background-dark': 'linear-gradient(to bottom, #1a1a2e, #16213e, #0f3460)', /* Main content background */
        '--background-darker': '#1e1e1e',
        '--text-color': '#ffffff',
        '--card-background': '#1e1e1e',
        '--neon-intensity': '0.4',
        '--neon-rgb': '26,26,46'
      },
      spring: {
        '--primary-color': '#98fb98',
        '--primary-dark': '#32cd32',
        '--background-dark': 'linear-gradient(to bottom, #98fb98, #32cd32, #228b22)',
        '--background-darker': '#1e1e1e',
        '--text-color': '#ffffff',
        '--card-background': '#1e1e1e',
        '--neon-intensity': '0.4',
        '--neon-rgb': '152,251,152'
      },
      volcano: {
        '--primary-color': '#ff4500',
        '--primary-dark': '#8b0000',
        '--background-dark': 'linear-gradient(to bottom, #ff4500, #ff6347, #8b0000)',
        '--background-darker': '#1e1e1e',
        '--text-color': '#ffffff',
        '--card-background': '#1e1e1e',
        '--neon-intensity': '0.4',
        '--neon-rgb': '255,69,0'
      }
    };

    // Hours for schedule table (08:00 to 18:00)
    const hours = [];
    for (let i = 8; i <= 18; i++) {
      let hourStr = i < 10 ? "0" + i : i;
      hours.push(hourStr + ":00");
    }

    // Functions for Active Schedule Days
    function getActiveScheduleDays() {
      let days = JSON.parse(localStorage.getItem("activeScheduleDays"));
      if (!days || days.length === 0) {
        days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"];
      }
      return days;
    }

    function updateActiveDaysSelector() {
      const activeDays = getActiveScheduleDays();
      document.querySelectorAll("#active-days-selector input[type=checkbox]").forEach(checkbox => {
        checkbox.checked = activeDays.includes(checkbox.value);
      });
    }

    document.getElementById("save-active-days").addEventListener("click", () => {
      const selectedDays = [];
      document.querySelectorAll("#active-days-selector input[type=checkbox]").forEach(checkbox => {
        if (checkbox.checked) {
          selectedDays.push(checkbox.value);
        }
      });
      localStorage.setItem("activeScheduleDays", JSON.stringify(selectedDays));
      renderScheduleTable();
      showNotification("Active days updated!");
    });

    // Generate Schedule Table based on active days
    function generateScheduleTable() {
      const activeDays = JSON.parse(localStorage.getItem("activeScheduleDays")) || ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"];
      let table = document.createElement("table");
      table.id = "schedule-table";
      // Header row
      let thead = document.createElement("thead");
      let headerRow = document.createElement("tr");
      let emptyTh = document.createElement("th");
      headerRow.appendChild(emptyTh);
      activeDays.forEach(day => {
        let th = document.createElement("th");
        th.textContent = day;
        headerRow.appendChild(th);
      });
      thead.appendChild(headerRow);
      table.appendChild(thead);
      // Body rows for each hour
      let tbody = document.createElement("tbody");
      hours.forEach(time => {
        let row = document.createElement("tr");
        let timeCell = document.createElement("td");
        timeCell.textContent = time;
        row.appendChild(timeCell);
        activeDays.forEach(day => {
          let cell = document.createElement("td");
          cell.id = "cell-" + day + "-" + time.substring(0,2);
          row.appendChild(cell);
        });
        tbody.appendChild(row);
      });
      table.appendChild(tbody);
      return table;
    }

    function renderScheduleTable() {
      const container = document.getElementById("schedule-table-container");
      container.innerHTML = "";
      const table = generateScheduleTable();
      container.appendChild(table);
      let scheduleItems = JSON.parse(localStorage.getItem("schedule")) || [];
      scheduleItems.forEach(item => {
        let hour = item.start.split(":")[0];
        let cell = document.getElementById("cell-" + item.day + "-" + hour);
        if (cell) {
          let div = document.createElement("div");
          div.className = "schedule-item";
          div.innerHTML = `<strong>${item.subject}</strong><br>${item.start} - ${item.end}<br>${item.location} <button onclick="deleteScheduleItem(${item.id})">x</button>`;
          cell.appendChild(div);
        }
      });
    }

    function deleteScheduleItem(id) {
      let scheduleItems = JSON.parse(localStorage.getItem("schedule")) || [];
      scheduleItems = scheduleItems.filter(item => item.id !== id);
      localStorage.setItem("schedule", JSON.stringify(scheduleItems));
      renderScheduleTable();
      showNotification("Schedule item deleted!");
    }
    window.deleteScheduleItem = deleteScheduleItem; // Expose to inline onclick

    document.addEventListener('DOMContentLoaded', function() {
      // Initialize localStorage keys
      const initializeSettings = () => {
        if (!localStorage.getItem('theme')) localStorage.setItem('theme', 'dark');
        if (!localStorage.getItem('premadeTheme')) localStorage.setItem('premadeTheme', 'classic');
        if (!localStorage.getItem('neonIntensity')) localStorage.setItem('neonIntensity', '0.3');
        if (!localStorage.getItem('tasks')) localStorage.setItem('tasks', JSON.stringify([]));
        if (!localStorage.getItem('events')) localStorage.setItem('events', JSON.stringify([]));
        if (!localStorage.getItem('projects')) localStorage.setItem('projects', JSON.stringify([]));
        if (!localStorage.getItem('notes')) localStorage.setItem('notes', JSON.stringify([]));
        if (!localStorage.getItem('contacts')) localStorage.setItem('contacts', JSON.stringify([]));
        if (!localStorage.getItem('files')) localStorage.setItem('files', JSON.stringify([]));
        if (!localStorage.getItem('schedule')) localStorage.setItem('schedule', JSON.stringify([]));
        if (!localStorage.getItem('fontFamily')) localStorage.setItem('fontFamily', 'Arial');
        if (!localStorage.getItem('textSize')) localStorage.setItem('textSize', '16');
        if (!localStorage.getItem('backgroundColor')) localStorage.setItem('backgroundColor', '#121212');
        if (!localStorage.getItem('soundNotifications')) localStorage.setItem('soundNotifications', 'true');
        if (!localStorage.getItem('welcomeMessage')) localStorage.setItem('welcomeMessage', 'Welcome back, User!');
      };
      initializeSettings();
      updateActiveDaysSelector();

      // Apply saved settings (including pre-made theme)
      const applySavedSettings = () => {
        const fontFamily = localStorage.getItem('fontFamily');
        const textSize = localStorage.getItem('textSize');
        const backgroundColor = localStorage.getItem('backgroundColor');
        const welcomeMessage = localStorage.getItem('welcomeMessage');
        const intensity = localStorage.getItem('neonIntensity');
        document.body.style.fontFamily = fontFamily;
        document.body.style.fontSize = textSize + 'px';
        document.body.style.backgroundColor = backgroundColor;
        document.getElementById('text-size-value').textContent = textSize;
        document.getElementById('welcome-message-display').textContent = welcomeMessage;
        document.getElementById('current-date-display').textContent = new Date().toLocaleDateString('en-GB');

        // Apply pre-made theme values
        const selectedTheme = localStorage.getItem('premadeTheme') || 'classic';
        const themeProps = preMadeThemes[selectedTheme];
        for (const prop in themeProps) {
          document.documentElement.style.setProperty(prop, themeProps[prop]);
        }
      };
      applySavedSettings();

      // Pre-made Themes Selector
      const premadeThemeSelect = document.getElementById('premade-theme');
      premadeThemeSelect.value = localStorage.getItem('premadeTheme') || 'classic';
      premadeThemeSelect.innerHTML += `
        <option value="skyline">Skyline</option>
        <option value="forest">Forest</option>
        <option value="sunset">Sunset</option>
        <option value="ocean">Ocean</option>
        <option value="dawn">Dawn</option>
        <option value="candy">Candy</option>
        <option value="galaxy">Galaxy</option>
        <option value="spring">Spring</option>
        <option value="volcano">Volcano</option>
      `;
      premadeThemeSelect.addEventListener('change', () => {
        const selected = premadeThemeSelect.value;
        localStorage.setItem('premadeTheme', selected);
        applySavedSettings();
        showNotification('Theme changed to ' + premadeThemeSelect.options[premadeThemeSelect.selectedIndex].text);
      });

      // Neon Intensity Bar Logic
      const intensityBar = document.getElementById('intensity-bar');
      const intensityLevels = intensityBar.querySelectorAll('.intensity-level');
      const intensityValueDisplay = document.getElementById('intensity-value');

      let intensity = parseFloat(localStorage.getItem('neonIntensity')) || 0.4;

      const updateBar = (level) => {
        intensityLevels.forEach((levelElement) => {
          const levelNumber = parseInt(levelElement.dataset.level, 10);
          if (levelNumber <= level) {
            levelElement.classList.add('active');
          } else {
            levelElement.classList.remove('active');
          }
        });
        const percentage = Math.round((level / 9) * 100);
        intensityValueDisplay.textContent = `${percentage}%`;
        const intensityValue = level / 9;
        document.documentElement.style.setProperty('--neon-intensity', intensityValue);
        localStorage.setItem('neonIntensity', intensityValue);
      };

      intensityLevels.forEach((levelElement) => {
        levelElement.addEventListener('click', () => {
          const level = parseInt(levelElement.dataset.level, 10);
          updateBar(level);
        });
      });

      // Initialize bar position
      const initialLevel = Math.round(intensity * 9);
      updateBar(initialLevel);

      // Page navigation
      const links = document.querySelectorAll('.sidebar a');
      const pages = document.querySelectorAll('.page');
      links.forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          const targetPage = link.getAttribute('data-page');
          links.forEach(l => l.classList.remove('active'));
          link.classList.add('active');
          pages.forEach(p => p.classList.remove('active'));
          document.getElementById(targetPage).classList.add('active');
        });
      });

      // Notification & Loading overlay
      const showNotification = (message) => {
        alert(message);
      };
      const showLoading = () => document.querySelector('.loading-overlay').style.display = 'flex';
      const hideLoading = () => document.querySelector('.loading-overlay').style.display = 'none';

      // --------------------------
      // TASK MANAGEMENT
      // --------------------------
      let currentFilter = 'all';
      const taskForm = document.getElementById('task-form');
      const taskList = document.getElementById('task-list');
      const taskInput = document.getElementById('task-input');
      const taskDueDate = document.getElementById('task-due-date');
      const taskPriority = document.getElementById('task-priority');

      const renderTasks = () => {
        let tasks = JSON.parse(localStorage.getItem('tasks'));
        if (currentFilter === 'completed') {
          tasks = tasks.filter(task => task.completed);
        } else if (currentFilter === 'pending') {
          tasks = tasks.filter(task => !task.completed);
        }
        taskList.innerHTML = '';
        tasks.forEach(task => {
          const li = document.createElement('li');
          li.setAttribute('data-id', task.id);
          li.innerHTML = `
            <div style="display:flex; align-items:center; gap:10px;">
              <input type="checkbox" ${task.completed ? 'checked' : ''}>
              <span class="${task.completed ? 'completed' : ''}">${task.title}</span>
              <span class="task-due-date">Due: ${task.dueDate}</span>
              <span class="task-priority ${task.priority}">${task.priority}</span>
            </div>
            <button class="delete-btn"><i class="fas fa-trash"></i></button>
          `;
          li.querySelector('input[type="checkbox"]').addEventListener('change', (e) => {
            const allTasks = JSON.parse(localStorage.getItem('tasks'));
            const idx = allTasks.findIndex(t => t.id === task.id);
            if (idx > -1) {
              allTasks[idx].completed = e.target.checked;
              localStorage.setItem('tasks', JSON.stringify(allTasks));
              renderTasks();
              showNotification('Task status updated!');
            }
          });
          li.querySelector('.delete-btn').addEventListener('click', () => {
            let allTasks = JSON.parse(localStorage.getItem('tasks'));
            allTasks = allTasks.filter(t => t.id !== task.id);
            localStorage.setItem('tasks', JSON.stringify(allTasks));
            renderTasks();
            showNotification('Task deleted!');
          });
          taskList.appendChild(li);
        });
        updateDashboardStats();
        updateRecentActivity();
      };

      taskForm.addEventListener('submit', (e) => {
        e.preventDefault();
        showLoading();
        const newTask = {
          id: Date.now(),
          title: taskInput.value,
          dueDate: taskDueDate.value,
          priority: taskPriority.value,
          completed: false
        };
        const allTasks = JSON.parse(localStorage.getItem('tasks'));
        allTasks.push(newTask);
        localStorage.setItem('tasks', JSON.stringify(allTasks));
        taskForm.reset();
        setTimeout(() => {
          hideLoading();
          renderTasks();
          showNotification('Task added successfully!');
        }, 500);
      });

      const filterButtons = document.querySelectorAll('.filter-btn');
      filterButtons.forEach(button => {
        button.addEventListener('click', () => {
          currentFilter = button.getAttribute('data-filter');
          filterButtons.forEach(btn => btn.classList.remove('active'));
          button.classList.add('active');
          renderTasks();
        });
      });

      // --------------------------
      // EVENT MANAGEMENT
      // --------------------------
      const eventForm = document.getElementById('event-form');
      const eventList = document.getElementById('event-list');
      const eventTitle = document.getElementById('event-title');
      const eventDate = document.getElementById('event-date');
      const eventTime = document.getElementById('event-time');
      const eventDescription = document.getElementById('event-description');

      const renderEvents = () => {
        let events = JSON.parse(localStorage.getItem('events'));
        events.sort((a, b) => new Date(a.date) - new Date(b.date));
        eventList.innerHTML = '';
        events.forEach((event, index) => {
          const li = document.createElement('li');
          li.innerHTML = `
            <div>
              <h3>${event.title}</h3>
              <p>${event.date} ${event.time}</p>
              <p>${event.description}</p>
            </div>
            <button class="delete-btn"><i class="fas fa-trash"></i></button>
          `;
          li.querySelector('.delete-btn').addEventListener('click', () => {
            let events = JSON.parse(localStorage.getItem('events'));
            events.splice(index, 1);
            localStorage.setItem('events', JSON.stringify(events));
            renderEvents();
            showNotification('Event deleted!');
            updateDashboardStats();
            updateRecentActivity();
          });
          eventList.appendChild(li);
        });
        updateDashboardStats();
        updateRecentActivity();
      };

      eventForm.addEventListener('submit', (e) => {
        e.preventDefault();
        showLoading();
        const newEvent = {
          title: eventTitle.value,
          date: eventDate.value,
          time: eventTime.value,
          description: eventDescription.value
        };
        const events = JSON.parse(localStorage.getItem('events'));
        events.push(newEvent);
        localStorage.setItem('events', JSON.stringify(events));
        eventForm.reset();
        setTimeout(() => {
          hideLoading();
          renderEvents();
          showNotification('Event added successfully!');
        }, 500);
      });

      // --------------------------
      // PROJECT MANAGEMENT
      // --------------------------
      const projectForm = document.getElementById('project-form');
      const projectGrid = document.querySelector('.project-grid');

      const renderProjects = () => {
        let projects = JSON.parse(localStorage.getItem('projects'));
        projectGrid.innerHTML = '';
        if (projects.length === 0) {
          projectGrid.innerHTML = '<p>No projects yet.</p>';
        } else {
          projects.forEach(project => {
            const card = document.createElement('div');
            card.className = 'project-card';
            card.innerHTML = `
              <h3>${project.name}</h3>
              <p>${project.description}</p>
              <span class="status ${project.status}">${project.status}</span>
              <p class="deadline">Deadline: ${project.deadline}</p>
              <button class="delete-btn"><i class="fas fa-trash"></i></button>
            `;
            card.querySelector('.delete-btn').addEventListener('click', () => {
              let projects = JSON.parse(localStorage.getItem('projects'));
              projects = projects.filter(p => p.id !== project.id);
              localStorage.setItem('projects', JSON.stringify(projects));
              renderProjects();
              showNotification('Project deleted!');
              updateDashboardStats();
              updateRecentActivity();
            });
            projectGrid.appendChild(card);
          });
        }
        updateDashboardStats();
        updateRecentActivity();
      };

      projectForm.addEventListener('submit', (e) => {
        e.preventDefault();
        showLoading();
        const newProject = {
          id: Date.now(),
          name: document.getElementById('project-name').value,
          description: document.getElementById('project-description').value,
          status: document.getElementById('project-status').value,
          deadline: document.getElementById('project-deadline').value
        };
        let projects = JSON.parse(localStorage.getItem('projects'));
        projects.push(newProject);
        localStorage.setItem('projects', JSON.stringify(projects));
        projectForm.reset();
        setTimeout(() => {
          hideLoading();
          renderProjects();
          showNotification('Project added successfully!');
        }, 500);
      });

      // --------------------------
      // FILE MANAGEMENT
      // --------------------------
      const fileInput = document.getElementById('file-input');
      const fileUploadArea = document.querySelector('.file-upload-area');
      const renderFiles = () => {
        const fileListContainer = document.getElementById('file-list');
        let storedFiles = JSON.parse(localStorage.getItem('files'));
        fileListContainer.innerHTML = '';
        if (storedFiles.length === 0) {
          fileListContainer.innerHTML = '<p>No files uploaded.</p>';
        } else {
          storedFiles.forEach(file => {
            const div = document.createElement('div');
            div.className = 'file-item';
            div.innerHTML = `<span>${file.name}</span>
              <button class="delete-btn"><i class="fas fa-trash"></i></button>`;
            div.querySelector('.delete-btn').addEventListener('click', () => {
              let storedFiles = JSON.parse(localStorage.getItem('files'));
              storedFiles = storedFiles.filter(f => f.id !== file.id);
              localStorage.setItem('files', JSON.stringify(storedFiles));
              renderFiles();
              showNotification('File removed!');
            });
            fileListContainer.appendChild(div);
          });
        }
      };

      fileUploadArea.addEventListener('click', () => {
        fileInput.click();
      });

      fileInput.addEventListener('change', () => {
        const files = Array.from(fileInput.files);
        let storedFiles = JSON.parse(localStorage.getItem('files'));
        files.forEach(file => {
          storedFiles.push({ id: Date.now() + Math.random(), name: file.name });
        });
        localStorage.setItem('files', JSON.stringify(storedFiles));
        renderFiles();
      });

      // --------------------------
      // NOTES MANAGEMENT
      // --------------------------
      const noteForm = document.getElementById('note-form');
      const notesContainer = document.querySelector('.notes-container');

      const renderNotes = () => {
        let notes = JSON.parse(localStorage.getItem('notes')) || [];
        notesContainer.innerHTML = '';
        if (notes.length === 0) {
          notesContainer.innerHTML = '<p>No notes available.</p>';
        } else {
          notes.forEach(note => {
            const div = document.createElement('div');
            div.className = 'note-card ' + note.category;
            div.innerHTML = `
              <h3>${note.title}</h3>
              <div>${note.content}</div>
              <span class="category">${note.category}</span>
              <button class="delete-btn"><i class="fas fa-trash"></i></button>
            `;
            div.querySelector('.delete-btn').addEventListener('click', () => {
              let notes = JSON.parse(localStorage.getItem('notes')) || [];
              notes = notes.filter(n => n.id !== note.id);
              localStorage.setItem('notes', JSON.stringify(notes));
              renderNotes();
            });
            notesContainer.appendChild(div);
          });
        }
      };

      noteForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const newNote = {
          id: Date.now(),
          title: document.getElementById('note-title').value,
          content: document.getElementById('note-content').innerHTML, // Save formatted content as HTML
          category: document.getElementById('note-category').value
        };
        let notes = JSON.parse(localStorage.getItem('notes')) || [];
        notes.push(newNote);
        localStorage.setItem('notes', JSON.stringify(notes));
        noteForm.reset();
        document.getElementById('note-content').innerHTML = ''; // Clear the rich text editor
        renderNotes();
      });

      // Function to clear all formatting and reset to plain text
      function clearFormatting() {
        const editor = document.getElementById('note-content');
        const plainText = editor.innerText; // Extract plain text
        editor.innerHTML = plainText; // Replace content with plain text
      }

      // Ensure toolbar buttons work for the rich text editor
      document.querySelectorAll('.toolbar button').forEach(button => {
        button.addEventListener('click', (e) => {
          e.preventDefault(); // Prevent form submission
        });
      });

      document.addEventListener('DOMContentLoaded', renderNotes);

      // --------------------------
      // CONTACTS MANAGEMENT
      // --------------------------
      const contactForm = document.getElementById('contact-form');
      const contactsList = document.querySelector('.contacts-list');

      const renderContacts = () => {
        let contacts = JSON.parse(localStorage.getItem('contacts'));
        contactsList.innerHTML = '';
        if (contacts.length === 0) {
          contactsList.innerHTML = '<p>No contacts available.</p>';
        } else {
          contacts.forEach(contact => {
            const div = document.createElement('div');
            div.className = 'contact-card ' + contact.category;
            div.innerHTML = `
              <div class="contact-info">
                <h3>${contact.name}</h3>
                <p><i class="fas fa-envelope"></i> ${contact.email}</p>
                <p><i class="fas fa-phone"></i> ${contact.phone}</p>
                <span class="category">${contact.category}</span>
                <p>${contact.notes}</p>
              </div>
              <button class="delete-btn"><i class="fas fa-trash"></i></button>
            `;
            div.querySelector('.delete-btn').addEventListener('click', () => {
              let contacts = JSON.parse(localStorage.getItem('contacts'));
              contacts = contacts.filter(c => c.id !== contact.id);
              localStorage.setItem('contacts', JSON.stringify(contacts));
              renderContacts();
              showNotification('Contact deleted!');
            });
            contactsList.appendChild(div);
          });
        }
      };

      contactForm.addEventListener('submit', (e) => {
        e.preventDefault();
        showLoading();
        const newContact = {
          id: Date.now(),
          name: document.getElementById('contact-name').value,
          email: document.getElementById('contact-email').value,
          phone: document.getElementById('contact-phone').value,
          category: document.getElementById('contact-category').value,
          notes: document.getElementById('contact-notes').value
        };
        let contacts = JSON.parse(localStorage.getItem('contacts'));
        contacts.push(newContact);
        localStorage.setItem('contacts', JSON.stringify(contacts));
        contactForm.reset();
        setTimeout(() => {
          hideLoading();
          renderContacts();
          showNotification('Contact added successfully!');
        }, 500);
      });

      // --------------------------
      // UNI SCHEDULE MANAGEMENT (Table with Active Days)
      // --------------------------
      const scheduleForm = document.getElementById('schedule-form');
      function generateScheduleTable() {
        const activeDays = JSON.parse(localStorage.getItem("activeScheduleDays")) || ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"];
        let table = document.createElement("table");
        table.id = "schedule-table";
        // Header row
        let thead = document.createElement("thead");
        let headerRow = document.createElement("tr");
        let emptyTh = document.createElement("th");
        headerRow.appendChild(emptyTh);
        activeDays.forEach(day => {
          let th = document.createElement("th");
          th.textContent = day;
          headerRow.appendChild(th);
        });
        thead.appendChild(headerRow);
        table.appendChild(thead);
        // Body rows for each hour
        let tbody = document.createElement("tbody");
        hours.forEach(time => {
          let row = document.createElement("tr");
          let timeCell = document.createElement("td");
          timeCell.textContent = time;
          row.appendChild(timeCell);
          activeDays.forEach(day => {
            let cell = document.createElement("td");
            cell.id = "cell-" + day + "-" + time.substring(0,2);
            row.appendChild(cell);
          });
          tbody.appendChild(row);
        });
        table.appendChild(tbody);
        return table;
      }

      function renderScheduleTable() {
        const container = document.getElementById("schedule-table-container");
        container.innerHTML = "";
        const table = generateScheduleTable();
        container.appendChild(table);
        let scheduleItems = JSON.parse(localStorage.getItem("schedule")) || [];
        scheduleItems.forEach(item => {
          let hour = item.start.split(":")[0];
          let cell = document.getElementById("cell-" + item.day + "-" + hour);
          if (cell) {
            let div = document.createElement("div");
            div.className = "schedule-item";
            div.innerHTML = `<strong>${item.subject}</strong><br>${item.start} - ${item.end}<br>${item.location} <button onclick="deleteScheduleItem(${item.id})">x</button>`;
            cell.appendChild(div);
          }
        });
      }

      function deleteScheduleItem(id) {
        let scheduleItems = JSON.parse(localStorage.getItem("schedule")) || [];
        scheduleItems = scheduleItems.filter(item => item.id !== id);
        localStorage.setItem("schedule", JSON.stringify(scheduleItems));
        renderScheduleTable();
        showNotification("Schedule item deleted!");
      }
      window.deleteScheduleItem = deleteScheduleItem; // Expose to inline onclick

      // Render Active Days Selector
      function updateActiveDaysSelector() {
        const activeDays = getActiveScheduleDays();
        document.querySelectorAll("#active-days-selector input[type=checkbox]").forEach(checkbox => {
          checkbox.checked = activeDays.includes(checkbox.value);
        });
      }

      function getActiveScheduleDays() {
        let days = JSON.parse(localStorage.getItem("activeScheduleDays"));
        if (!days || days.length === 0) {
          days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"];
        }
        return days;
      }

      document.getElementById("save-active-days").addEventListener("click", () => {
        const selectedDays = [];
        document.querySelectorAll("#active-days-selector input[type=checkbox]").forEach(checkbox => {
          if (checkbox.checked) {
            selectedDays.push(checkbox.value);
          }
        });
        localStorage.setItem("activeScheduleDays", JSON.stringify(selectedDays));
        renderScheduleTable();
        showNotification("Active days updated!");
      });

      scheduleForm.addEventListener('submit', (e) => {
        e.preventDefault();
        showLoading();
        let scheduleItems = JSON.parse(localStorage.getItem('schedule')) || [];
        const newItem = {
          id: Date.now(),
          subject: document.getElementById('schedule-subject').value,
          day: document.getElementById('schedule-day').value,
          start: document.getElementById('schedule-start').value,
          end: document.getElementById('schedule-end').value,
          location: document.getElementById('schedule-location').value
        };
        scheduleItems.push(newItem);
        localStorage.setItem('schedule', JSON.stringify(scheduleItems));
        scheduleForm.reset();
        setTimeout(() => {
          hideLoading();
          renderScheduleTable();
          showNotification('Schedule item added!');
        }, 500);
      });

      // --------------------------
      // DASHBOARD STATS & RECENT ACTIVITY
      // --------------------------
      const updateDashboardStats = () => {
        const tasks = JSON.parse(localStorage.getItem('tasks'));
        const activeTasksCount = tasks.filter(task => !task.completed).length;
        document.getElementById('active-tasks-count').textContent = activeTasksCount;

        const events = JSON.parse(localStorage.getItem('events'));
        const todayIso = new Date().toISOString().split('T')[0];
        const eventsToday = events.filter(event => event.date === todayIso).length;
        document.getElementById('events-today-count').textContent = eventsToday;

        const projects = JSON.parse(localStorage.getItem('projects'));
        document.getElementById('projects-count').textContent = projects.length;
      };

      // Recent Activity: show the most recent task, event, and project
      const updateRecentActivity = () => {
        const tasks = JSON.parse(localStorage.getItem('tasks'));
        const events = JSON.parse(localStorage.getItem('events'));
        const projects = JSON.parse(localStorage.getItem('projects'));
        let activityItems = [];
        if (tasks.length > 0) {
          const recentTask = tasks.sort((a, b) => b.id - a.id)[0];
          activityItems.push(`<li><strong>Task:</strong> ${recentTask.title} (Due: ${recentTask.dueDate})</li>`);
        }
        if (events.length > 0) {
          const recentEvent = events.sort((a, b) => b.id - a.id)[0];
          activityItems.push(`<li><strong>Event:</strong> ${recentEvent.title} at ${recentEvent.time}</li>`);
        }
        if (projects.length > 0) {
          const recentProject = projects.sort((a, b) => b.id - a.id)[0];
          activityItems.push(`<li><strong>Project:</strong> ${recentProject.name} (${recentProject.status})</li>`);
        }
        const container = document.getElementById('recent-activity-content');
        if (activityItems.length === 0) {
          container.innerHTML = `<p style="text-align:center; font-style:italic;">No recent activity.</p>`;
        } else {
          container.innerHTML = `<ul>${activityItems.join('')}</ul>`;
        }
      };

      // Initial dashboard updates
      updateDashboardStats();
      updateRecentActivity();

      // --------------------------
      // ADVANCED SETTINGS
      // --------------------------
      const fontFamilySelect = document.getElementById('font-family');
      const textSizeSlider = document.getElementById('text-size');
      const textSizeValue = document.getElementById('text-size-value');
      const soundNotificationsCheckbox = document.getElementById('sound-notifications');
      const welcomeMessageInput = document.getElementById('welcome-message');
      const resetSettingsBtn = document.getElementById('reset-settings');

      fontFamilySelect.value = localStorage.getItem('fontFamily');
      textSizeSlider.value = localStorage.getItem('textSize');
      textSizeValue.textContent = localStorage.getItem('textSize');
      soundNotificationsCheckbox.checked = localStorage.getItem('soundNotifications') === 'true';
      welcomeMessageInput.value = localStorage.getItem('welcomeMessage');

      fontFamilySelect.addEventListener('change', () => {
        localStorage.setItem('fontFamily', fontFamilySelect.value);
        document.body.style.fontFamily = fontFamilySelect.value;
        showNotification('Font changed to ' + fontFamilySelect.value);
      });

      textSizeSlider.addEventListener('input', () => {
        localStorage.setItem('textSize', textSizeSlider.value);
        document.body.style.fontSize = textSizeSlider.value + 'px';
        textSizeValue.textContent = textSizeSlider.value;
      });

      soundNotificationsCheckbox.addEventListener('change', () => {
        localStorage.setItem('soundNotifications', soundNotificationsCheckbox.checked);
        showNotification('Sound notifications ' + (soundNotificationsCheckbox.checked ? 'enabled' : 'disabled'));
      });

      welcomeMessageInput.addEventListener('change', () => {
        localStorage.setItem('welcomeMessage', welcomeMessageInput.value);
        document.getElementById('welcome-message-display').textContent = welcomeMessageInput.value;
        showNotification('Welcome message updated');
      });

      resetSettingsBtn.addEventListener('click', () => {
        if (confirm("Are you sure you want to reset ALL data and settings? This cannot be undone.")) {
          localStorage.clear();
          location.reload();
        }
      });

      // --------------------------
      // DARK MODE TOGGLE
      // --------------------------
      const darkModeToggle = document.getElementById('dark-mode-toggle');
      darkModeToggle.addEventListener('change', () => {
        const isDarkMode = darkModeToggle.checked;
        document.body.classList.toggle('dark-mode', isDarkMode);
        localStorage.setItem('darkMode', isDarkMode);
      });
      if (localStorage.getItem('darkMode') === 'true') {
        document.body.classList.add('dark-mode');
        darkModeToggle.checked = true;
      }

      // --------------------------
      // LANGUAGE SELECTOR
      // --------------------------
      const languageSelector = document.getElementById('language-selector');
      languageSelector.addEventListener('change', () => {
        const selectedLanguage = languageSelector.value;
        localStorage.setItem('language', selectedLanguage);
        alert(`Language changed to: ${languageSelector.options[languageSelector.selectedIndex].text}`);
      });
      languageSelector.value = localStorage.getItem('language') || 'en';

      // --------------------------
      // INITIAL RENDERS
      // --------------------------
      renderTasks();
      renderEvents();
      renderProjects();
      renderFiles();
      renderNotes();
      renderContacts();
      renderScheduleTable();
    });
  </script>
</body>
</html>
